<!DOCTYPE html>
<!--
  1. xmlns:layout 속성으로 Thymeleaf Layout Dialect를 사용한다고 선언합니다.
  2. layout:decorate 속성으로 이 페이지의 전체적인 틀(Layout)이 될 파일을 지정합니다.
-->
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{users/mypage/layout}">

<!--
  <head> 태그 안에 있는 내용은 layout.html의 <head> 내용과 병합됩니다.
  여기서 정의한 <title>은 layout.html의 <title>을 덮어쓰거나 패턴에 맞춰 적용됩니다.
-->
<head>
  <title>예약 상세 정보</title>
</head>

<body>

<!--
  layout:fragment="content" 속성은 이 <section> 태그의 내용이
  layout.html 파일에 있는 layout:fragment="content" 부분을 대체할 "알맹이"라는 것을 의미합니다.
-->
<section layout:fragment="content">
  <h1>예약 상세 정보</h1>

  <!-- 컨트롤러에서 전달한 'bookingDetail' 객체를 사용하기 위해 th:object를 선언합니다. -->
  <div th:object="${bookingDetail}">

    <!-- 예약 상품 정보 섹션 -->
    <div class="detail-section">
      <div class="detail-section-header" th:text="*{bookingInfo.productName}">상품 이름</div>
      <div class="detail-section-body">
        <dl class="detail-list">
          <div>
            <dt>예약 번호</dt>
            <dd th:text="*{bookingInfo.bookingNumber}">MT-20250928-12345</dd>
          </div>
          <div>
            <dt>예약 상태</dt>
            <dd th:text="*{bookingInfo.status.name()}">CONFIRMED</dd>
          </div>
          <div>
            <dt>출발일</dt>
            <dd th:text="*{bookingInfo.departureDate}">2025-10-10</dd>
          </div>
          <div>
            <dt>총 예약 금액</dt>
            <dd th:text="|₩${#numbers.formatInteger(bookingInfo.totalPrice, 3, 'COMMA')}|">₩1,000,000</dd>
          </div>
        </dl>
      </div>
    </div>

    <!-- 결제 정보 섹션 -->
    <!-- th:if를 사용하여 결제 정보(paymentInfo)가 존재할 경우에만 이 섹션을 보여줍니다. -->
    <div class="detail-section" th:if="*{paymentInfo != null}">
      <div class="detail-section-header">결제 정보</div>
      <div class="detail-section-body">
        <dl class="detail-list">
          <div>
            <dt>결제 수단</dt>
            <dd th:text="*{paymentInfo.paymentMethod}">card</dd>
          </div>
          <div>
            <dt>실제 결제 금액</dt>
            <dd th:text="|₩${#numbers.formatInteger(paymentInfo.amount, 3, 'COMMA')}|">₩1,000,000</dd>
          </div>
          <div>
            <dt>아임포트 거래 ID</dt>
            <dd th:text="*{paymentInfo.pgTransactionId}">imp_1234567890</dd>
          </div>
        </dl>
      </div>
    </div>

    <!-- 예약 취소 버튼 (예약 상태가 '확정'일 경우에만 표시) -->
    <div style="text-align: right; margin-top: 20px;" th:if="${bookingDetail.bookingInfo.status.name() == 'CONFIRMED'}">
      <button class="btn btn-danger">예약 취소</button>
    </div>

    <!-- 목록으로 돌아가기 버튼 -->
    <div style="text-align: center; margin-top: 30px;">
      <a th:href="@{/users/mypage/bookings}" class="btn btn-secondary">목록으로 돌아가기</a>
    </div>

  </div>
</section>

</body>
</html>